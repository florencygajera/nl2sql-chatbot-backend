<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QueryMind â€” NL to SQL</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Syne:wght@400;600;700;800&display=swap"
    rel="stylesheet" />

  <style>
    /* â”€â”€ Reset & Variables â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --bg: #080c10;
      --bg2: #0e1318;
      --bg3: #141b22;
      --border: #1e2a35;
      --border2: #243040;
      --accent: #00d4aa;
      --accent2: #00a88a;
      --accent-dim: rgba(0, 212, 170, 0.12);
      --accent-glow: rgba(0, 212, 170, 0.25);
      --text: #d0dde8;
      --text-dim: #607080;
      --text-muted: #3a4a58;
      --user-bg: #0a1f30;
      --user-border: #0d3050;
      --red: #ff5f6d;
      --yellow: #ffd166;
      --blue: #4fc3f7;
      --radius: 14px;
      --font-ui: 'Syne', sans-serif;
      --font-mono: 'Space Mono', monospace;
    }

    html,
    body {
      height: 100%;
      background: var(--bg);
      color: var(--text);
      font-family: var(--font-ui);
      overflow: hidden;
    }

    /* â”€â”€ Grid Background â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(rgba(0, 212, 170, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 212, 170, 0.03) 1px, transparent 1px);
      background-size: 40px 40px;
      pointer-events: none;
      z-index: 0;
    }

    /* â”€â”€ Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .app {
      position: relative;
      z-index: 1;
      display: grid;
      grid-template-rows: auto 1fr auto;
      height: 100vh;
      max-width: 900px;
      margin: 0 auto;
    }

    /* â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 18px 28px;
      border-bottom: 1px solid var(--border);
      background: rgba(8, 12, 16, 0.85);
      backdrop-filter: blur(12px);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-icon {
      width: 36px;
      height: 36px;
      border: 2px solid var(--accent);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: var(--font-mono);
      font-size: 14px;
      color: var(--accent);
      font-weight: 700;
      box-shadow: 0 0 16px var(--accent-glow);
      animation: pulse-border 3s ease-in-out infinite;
    }

    @keyframes pulse-border {

      0%,
      100% {
        box-shadow: 0 0 16px var(--accent-glow);
      }

      50% {
        box-shadow: 0 0 28px var(--accent-glow), 0 0 8px var(--accent);
      }
    }

    .logo-text {
      font-size: 18px;
      font-weight: 800;
      letter-spacing: -0.3px;
      color: #fff;
    }

    .logo-text span {
      color: var(--accent);
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 8px var(--accent);
      animation: blink 2.5s ease-in-out infinite;
    }

    .status-dot.offline {
      background: var(--red);
      box-shadow: 0 0 8px var(--red);
      animation: none;
    }

    @keyframes blink {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.4;
      }
    }

    .status-label {
      font-family: var(--font-mono);
      font-size: 11px;
      color: var(--text-dim);
      letter-spacing: 0.5px;
    }

    .backend-url-input {
      background: var(--bg3);
      border: 1px solid var(--border2);
      border-radius: 8px;
      padding: 6px 12px;
      color: var(--text);
      font-family: var(--font-mono);
      font-size: 11px;
      width: 200px;
      outline: none;
      transition: border-color 0.2s;
    }

    .backend-url-input:focus {
      border-color: var(--accent);
    }

    /* â”€â”€ Add SQL (+) Button â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .add-sql-btn {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: var(--bg3);
      border: 1px solid var(--border2);
      color: var(--accent);
      font-family: var(--font-mono);
      font-size: 18px;
      font-weight: 800;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      box-shadow: 0 0 0 0 rgba(0, 212, 170, 0.0);
    }

    .add-sql-btn:hover {
      border-color: var(--accent);
      background: var(--accent-dim);
      transform: translateY(-1px);
      box-shadow: 0 0 0 3px var(--accent-dim);
    }

    .add-sql-btn:active {
      transform: scale(0.96);
    }

    /* â”€â”€ Chat Area â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .chat-area {
      overflow-y: auto;
      padding: 24px 28px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      scroll-behavior: smooth;
    }

    .chat-area::-webkit-scrollbar {
      width: 4px;
    }

    .chat-area::-webkit-scrollbar-track {
      background: transparent;
    }

    .chat-area::-webkit-scrollbar-thumb {
      background: var(--border2);
      border-radius: 4px;
    }

    /* â”€â”€ Welcome â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .welcome {
      text-align: center;
      padding: 48px 24px;
      animation: fadeUp 0.6s ease both;
    }

    .welcome-icon {
      font-size: 48px;
      margin-bottom: 20px;
      filter: drop-shadow(0 0 20px var(--accent-glow));
    }

    .welcome h2 {
      font-size: 28px;
      font-weight: 800;
      color: #fff;
      margin-bottom: 10px;
    }

    .welcome p {
      color: var(--text-dim);
      font-size: 15px;
      max-width: 400px;
      margin: 0 auto 32px;
      line-height: 1.6;
    }

    .example-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      max-width: 600px;
      margin: 0 auto;
    }

    .chip {
      background: var(--bg3);
      border: 1px solid var(--border2);
      border-radius: 100px;
      padding: 8px 18px;
      font-size: 13px;
      color: var(--text-dim);
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }

    .chip:hover {
      border-color: var(--accent);
      color: var(--accent);
      background: var(--accent-dim);
      transform: translateY(-1px);
    }

    /* â”€â”€ Messages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .message {
      display: flex;
      gap: 14px;
      animation: fadeUp 0.35s ease both;
      max-width: 100%;
    }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(12px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .message.user {
      flex-direction: row-reverse;
    }

    .avatar {
      width: 34px;
      height: 34px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 15px;
      flex-shrink: 0;
      margin-top: 2px;
    }

    .message.user .avatar {
      background: var(--user-bg);
      border: 1px solid var(--user-border);
      font-size: 14px;
    }

    .message.bot .avatar {
      background: var(--accent-dim);
      border: 1px solid rgba(0, 212, 170, 0.3);
    }

    .bubble {
      flex: 1;
      min-width: 0;
    }

    .bubble-inner {
      padding: 14px 18px;
      border-radius: var(--radius);
      font-size: 14.5px;
      line-height: 1.65;
      max-width: 100%;
    }

    .message.user .bubble-inner {
      background: var(--user-bg);
      border: 1px solid var(--user-border);
      color: var(--text);
      border-radius: var(--radius) 4px var(--radius) var(--radius);
    }

    .message.bot .bubble-inner {
      background: var(--bg2);
      border: 1px solid var(--border);
      color: var(--text);
      border-radius: 4px var(--radius) var(--radius) var(--radius);
    }

    .bubble-meta {
      font-family: var(--font-mono);
      font-size: 10px;
      color: var(--text-muted);
      margin-top: 6px;
      padding: 0 2px;
    }

    .message.user .bubble-meta {
      text-align: right;
    }

    /* â”€â”€ Mode Badge â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .mode-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-family: var(--font-mono);
      font-size: 10px;
      padding: 3px 10px;
      border-radius: 100px;
      margin-bottom: 12px;
      letter-spacing: 0.5px;
      font-weight: 700;
    }

    .mode-badge.db {
      background: rgba(0, 212, 170, 0.12);
      color: var(--accent);
      border: 1px solid rgba(0, 212, 170, 0.25);
    }

    .mode-badge.chat {
      background: rgba(79, 195, 247, 0.12);
      color: var(--blue);
      border: 1px solid rgba(79, 195, 247, 0.25);
    }

    .mode-badge.clarify {
      background: rgba(255, 209, 102, 0.12);
      color: var(--yellow);
      border: 1px solid rgba(255, 209, 102, 0.25);
    }

    .mode-badge.error {
      background: rgba(255, 95, 109, 0.12);
      color: var(--red);
      border: 1px solid rgba(255, 95, 109, 0.25);
    }

    /* â”€â”€ SQL Block â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .sql-block {
      background: #050810;
      border: 1px solid var(--border2);
      border-left: 3px solid var(--accent);
      border-radius: 10px;
      overflow: hidden;
      margin: 12px 0;
    }

    .sql-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 14px;
      background: rgba(0, 212, 170, 0.06);
      border-bottom: 1px solid var(--border);
    }

    .sql-header-left {
      display: flex;
      align-items: center;
      gap: 8px;
      font-family: var(--font-mono);
      font-size: 10px;
      color: var(--accent);
      font-weight: 700;
      letter-spacing: 1px;
    }

    .copy-btn {
      background: none;
      border: 1px solid var(--border2);
      color: var(--text-dim);
      font-family: var(--font-mono);
      font-size: 10px;
      padding: 3px 10px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .copy-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
    }

    .copy-btn.copied {
      color: var(--accent);
      border-color: var(--accent);
    }

    .sql-code {
      padding: 14px 16px;
      font-family: var(--font-mono);
      font-size: 12.5px;
      color: #b8d4f0;
      line-height: 1.7;
      overflow-x: auto;
      white-space: pre;
    }

    /* SQL Syntax Highlighting */
    .kw {
      color: #c792ea;
      font-weight: 700;
    }

    .fn {
      color: #82aaff;
    }

    .str {
      color: #c3e88d;
    }

    .num {
      color: #f78c6c;
    }

    .op {
      color: var(--accent);
    }

    /* â”€â”€ Results Table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .results-block {
      margin: 12px 0;
      border: 1px solid var(--border);
      border-radius: 10px;
      overflow: hidden;
    }

    .results-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 14px;
      background: var(--bg3);
      border-bottom: 1px solid var(--border);
    }

    .results-header-left {
      font-family: var(--font-mono);
      font-size: 10px;
      color: var(--text-dim);
      letter-spacing: 0.5px;
    }

    .row-count {
      font-family: var(--font-mono);
      font-size: 10px;
      color: var(--accent);
      background: var(--accent-dim);
      padding: 2px 8px;
      border-radius: 100px;
    }

    .table-wrap {
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }

    thead tr {
      background: var(--bg3);
      border-bottom: 1px solid var(--border2);
    }

    th {
      padding: 10px 14px;
      font-family: var(--font-mono);
      font-size: 10px;
      font-weight: 700;
      color: var(--accent);
      text-align: left;
      letter-spacing: 0.8px;
      white-space: nowrap;
    }

    td {
      padding: 9px 14px;
      color: var(--text);
      border-bottom: 1px solid var(--border);
      font-family: var(--font-mono);
      font-size: 12px;
      white-space: nowrap;
    }

    tbody tr:last-child td {
      border-bottom: none;
    }

    tbody tr:hover td {
      background: rgba(255, 255, 255, 0.02);
    }

    /* â”€â”€ Explanation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .explanation {
      font-size: 13.5px;
      color: var(--text-dim);
      line-height: 1.6;
      padding: 10px 0 4px;
      border-top: 1px solid var(--border);
      margin-top: 12px;
    }

    /* â”€â”€ Clarify Block â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .clarify-block {
      background: rgba(255, 209, 102, 0.05);
      border: 1px solid rgba(255, 209, 102, 0.2);
      border-radius: 10px;
      padding: 14px 16px;
      margin: 8px 0;
    }

    .clarify-question {
      font-size: 14px;
      color: var(--text);
      margin-bottom: 10px;
    }

    .clarify-missing {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .missing-tag {
      background: rgba(255, 209, 102, 0.1);
      border: 1px solid rgba(255, 209, 102, 0.3);
      color: var(--yellow);
      font-family: var(--font-mono);
      font-size: 11px;
      padding: 3px 10px;
      border-radius: 100px;
    }

    /* â”€â”€ Typing Indicator â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .typing-indicator {
      display: flex;
      gap: 5px;
      align-items: center;
      padding: 14px 18px;
    }

    .dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: var(--accent);
      opacity: 0.3;
      animation: dotPulse 1.4s ease-in-out infinite;
    }

    .dot:nth-child(2) {
      animation-delay: 0.2s;
    }

    .dot:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes dotPulse {

      0%,
      100% {
        opacity: 0.3;
        transform: scale(1);
      }

      50% {
        opacity: 1;
        transform: scale(1.3);
      }
    }

    /* â”€â”€ Input Area â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .input-area {
      padding: 20px 28px 28px;
      border-top: 1px solid var(--border);
      background: rgba(8, 12, 16, 0.85);
      backdrop-filter: blur(12px);
    }

    .input-wrapper {
      display: flex;
      gap: 12px;
      align-items: flex-end;
      background: var(--bg2);
      border: 1px solid var(--border2);
      border-radius: 16px;
      padding: 12px 14px;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .input-wrapper:focus-within {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-dim);
    }

    #userInput {
      flex: 1;
      background: none;
      border: none;
      outline: none;
      color: var(--text);
      font-family: var(--font-ui);
      font-size: 15px;
      resize: none;
      min-height: 24px;
      max-height: 120px;
      line-height: 1.5;
    }

    #userInput::placeholder {
      color: var(--text-muted);
    }

    .send-btn {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      background: var(--accent);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all 0.2s;
      color: #080c10;
    }

    .send-btn:hover {
      background: var(--accent2);
      transform: scale(1.05);
    }

    .send-btn:active {
      transform: scale(0.96);
    }

    .send-btn:disabled {
      background: var(--border2);
      cursor: not-allowed;
      transform: none;
    }

    .send-btn svg {
      width: 18px;
      height: 18px;
    }

    .input-hint {
      font-family: var(--font-mono);
      font-size: 10px;
      color: var(--text-muted);
      margin-top: 10px;
      text-align: center;
    }

    /* â”€â”€ Params Block â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .params-block {
      font-family: var(--font-mono);
      font-size: 11px;
      color: var(--text-dim);
      background: var(--bg3);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 8px 12px;
      margin: 8px 0;
    }

    .params-label {
      color: var(--accent);
      margin-bottom: 4px;
      font-size: 10px;
      letter-spacing: 0.5px;
    }

    .param-row {
      display: flex;
      gap: 8px;
    }

    .param-key {
      color: var(--blue);
    }

    .param-val {
      color: #c3e88d;
    }
  </style>
</head>

<body>
  <div class="app">

    <!-- â”€â”€ Header â”€â”€ -->
    <header>
      <div class="logo">
        <div class="logo-icon">Q/</div>
        <span class="logo-text">Query<span>Mind</span></span>
      </div>

      <div class="header-right">
        <!-- âœ… + Add SQL file button -->
        <button class="add-sql-btn" id="addSqlBtn" title="Add .sql file">+</button>
        <input id="sqlFileInput" type="file" accept=".sql" style="display:none" />

        <input class="backend-url-input" id="backendUrl" type="text" value="http://localhost:8000"
          placeholder="Backend URL" />
        <div class="status-dot" id="statusDot"></div>
        <span class="status-label" id="statusLabel">CHECKING...</span>
      </div>
    </header>

    <!-- â”€â”€ Chat â”€â”€ -->
    <div class="chat-area" id="chatArea">
      <div class="welcome" id="welcome">
        <div class="welcome-icon">ğŸ§ </div>
        <h2>Ask your database anything</h2>
        <p>Type a question in plain English. QueryMind converts it to SQL and fetches real results.</p>
        <div class="example-chips">
          <div class="chip" onclick="sendChip(this)">Total salary of all employees</div>
          <div class="chip" onclick="sendChip(this)">Department-wise salary totals</div>
          <div class="chip" onclick="sendChip(this)">Top 5 highest paid in IT</div>
          <div class="chip" onclick="sendChip(this)">Employees hired after 2020</div>
          <div class="chip" onclick="sendChip(this)">Average salary by job title</div>
          <div class="chip" onclick="sendChip(this)">Give me only the SQL for headcount per department</div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ Input â”€â”€ -->
    <div class="input-area">
      <div class="input-wrapper">
        <textarea id="userInput" rows="1" placeholder="Ask something about your employee dataâ€¦"></textarea>
        <button class="send-btn" id="sendBtn" onclick="sendMessage()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
            stroke-linejoin="round">
            <line x1="22" y1="2" x2="11" y2="13"></line>
            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
          </svg>
        </button>
      </div>
      <div class="input-hint">Enter to send Â· Shift+Enter for new line Â· Tip: say "only sql" or "only answer" to control
        output</div>
    </div>

  </div>

  <script>
    // â”€â”€ Config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const getBackendUrl = () => document.getElementById('backendUrl').value.replace(/\/$/, '');

    // â”€â”€ SQL File (+) Upload (FIXED: uploads to backend + resets input) â”€â”€â”€â”€â”€â”€
    const addSqlBtn = document.getElementById('addSqlBtn');
    const sqlFileInput = document.getElementById('sqlFileInput');

    let uploadedSqlText = "";
    let uploadedSqlName = "";

    addSqlBtn.addEventListener('click', () => {
      sqlFileInput.value = ""; // âœ… important: allow selecting same file again
      sqlFileInput.click();
    });

    sqlFileInput.addEventListener('change', async () => {
      const file = sqlFileInput.files?.[0];
      if (!file) return;

      if (!file.name.toLowerCase().endsWith('.sql')) {
        alert('Please select a .sql file');
        return;
      }

      uploadedSqlText = await file.text();
      uploadedSqlName = file.name;

      hideWelcome();
      appendBotResponse({
        type: "CHAT",
        answer: `ğŸ“„ Loaded SQL file: "${uploadedSqlName}" (${uploadedSqlText.length} chars). Uploading to backend...`
      });

      // âœ… Upload to backend endpoint: POST /api/v1/upload-sql
      try {
        const formData = new FormData();
        formData.append("file", file);

        const res = await fetch(`${getBackendUrl()}/api/v1/upload-sql`, {
          method: "POST",
          body: formData,
          signal: AbortSignal.timeout(30000),
        });

        if (!res.ok) {
          const err = await res.text();
          appendBotError(`Upload failed: HTTP ${res.status}: ${err}`);
          return;
        }

        const out = await res.json();
        appendBotResponse({
          type: "CHAT",
          answer: `âœ… Uploaded successfully: "${out.filename}" (${out.bytes} bytes).`
        });
      } catch (e) {
        appendBotError(e?.message || "Upload error â€” is backend running?");
      }
    });

    // â”€â”€ Health check â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function checkHealth() {
      const dot = document.getElementById('statusDot');
      const label = document.getElementById('statusLabel');
      try {
        const r = await fetch(`${getBackendUrl()}/api/v1/health`, { signal: AbortSignal.timeout(4000) });
        const d = await r.json();
        if (d.status === 'ok') {
          dot.className = 'status-dot';
          label.textContent = 'CONNECTED';
        } else {
          dot.className = 'status-dot offline';
          label.textContent = 'DB OFFLINE';
        }
      } catch {
        dot.className = 'status-dot offline';
        label.textContent = 'OFFLINE';
      }
    }

    checkHealth();
    setInterval(checkHealth, 10000);
    document.getElementById('backendUrl').addEventListener('change', checkHealth);

    // â”€â”€ Auto-resize textarea â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const ta = document.getElementById('userInput');
    ta.addEventListener('input', () => {
      ta.style.height = 'auto';
      ta.style.height = Math.min(ta.scrollHeight, 120) + 'px';
    });

    ta.addEventListener('keydown', e => {
      if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); }
    });

    // â”€â”€ Chips â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function sendChip(el) {
      ta.value = el.textContent;
      sendMessage();
    }

    // â”€â”€ Send â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function sendMessage() {
      const text = ta.value.trim();
      if (!text) return;

      hideWelcome();
      appendUserMessage(text);
      ta.value = '';
      ta.style.height = 'auto';
      document.getElementById('sendBtn').disabled = true;

      const typingId = appendTyping();

      try {
        const payload = { message: text };

        // If your backend supports these, uncomment:
        // payload.schema_sql = uploadedSqlText;
        // payload.schema_filename = uploadedSqlName;

        const res = await fetch(`${getBackendUrl()}/api/v1/chat`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload),
          signal: AbortSignal.timeout(60000),
        });

        removeTyping(typingId);

        if (!res.ok) {
          const err = await res.text();
          appendBotError(`HTTP ${res.status}: ${err}`);
          return;
        }

        const data = await res.json();
        appendBotResponse(data);

      } catch (err) {
        removeTyping(typingId);
        appendBotError(err?.message || 'Network error â€” is the backend running?');
      } finally {
        document.getElementById('sendBtn').disabled = false;
        ta.focus();
      }
    }

    // â”€â”€ DOM Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function hideWelcome() {
      const w = document.getElementById('welcome');
      if (w) w.remove();
    }

    function scrollToBottom() {
      const ca = document.getElementById('chatArea');
      ca.scrollTop = ca.scrollHeight;
    }

    function now() {
      return new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }

    function appendUserMessage(text) {
      const ca = document.getElementById('chatArea');
      const div = document.createElement('div');
      div.className = 'message user';
      div.innerHTML = `
      <div class="avatar">ğŸ‘¤</div>
      <div class="bubble">
        <div class="bubble-inner">${escHtml(text)}</div>
        <div class="bubble-meta">${now()}</div>
      </div>`;
      ca.appendChild(div);
      scrollToBottom();
    }

    function appendTyping() {
      const ca = document.getElementById('chatArea');
      const id = 'typing-' + Date.now();
      const div = document.createElement('div');
      div.id = id;
      div.className = 'message bot';
      div.innerHTML = `
      <div class="avatar">âš¡</div>
      <div class="bubble">
        <div class="bubble-inner">
          <div class="typing-indicator">
            <div class="dot"></div><div class="dot"></div><div class="dot"></div>
          </div>
        </div>
      </div>`;
      ca.appendChild(div);
      scrollToBottom();
      return id;
    }

    function removeTyping(id) {
      document.getElementById(id)?.remove();
    }

    function appendBotError(msg) {
      const ca = document.getElementById('chatArea');
      const div = document.createElement('div');
      div.className = 'message bot';
      div.innerHTML = `
      <div class="avatar">âš¡</div>
      <div class="bubble">
        <div class="bubble-inner">
          <span class="mode-badge error">âš  ERROR</span>
          <div style="color:var(--red);font-family:var(--font-mono);font-size:13px;">${escHtml(msg)}</div>
        </div>
        <div class="bubble-meta">${now()}</div>
      </div>`;
      ca.appendChild(div);
      scrollToBottom();
    }

    // â”€â”€ Response Renderer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function appendBotResponse(data) {
      const ca = document.getElementById('chatArea');
      const div = document.createElement('div');
      div.className = 'message bot';

      let inner = '';

      if (data.type === 'CHAT') {
        inner = `
        <span class="mode-badge chat">ğŸ’¬ CHAT</span>
        <div>${escHtml(data.answer)}</div>`;

      } else if (data.type === 'CLARIFY') {
        const tags = (data.missing || []).map(m => `<span class="missing-tag">${escHtml(m)}</span>`).join('');
        inner = `
        <span class="mode-badge clarify">â“ CLARIFY</span>
        <div class="clarify-block">
          <div class="clarify-question">${escHtml(data.question)}</div>
          ${tags ? `<div class="clarify-missing">${tags}</div>` : ''}
        </div>`;

      } else if (data.type === 'DB') {
        const mode = data.mode || 'QUERY_AND_ANSWER';
        inner = `<span class="mode-badge db">âš¡ ${escHtml(mode)}</span>`;

        if (data.sql) {
          const sqlId = 'sql-' + Date.now();
          const safeSqlForTemplate = String(data.sql).replace(/`/g, '\\`');
          inner += `
          <div class="sql-block">
            <div class="sql-header">
              <div class="sql-header-left">
                <span>â–¶</span> SQL QUERY
              </div>
              <button class="copy-btn" id="copy-${sqlId}" onclick="copySQL('${sqlId}', \`${safeSqlForTemplate}\`)">Copy</button>
            </div>
            <div class="sql-code" id="${sqlId}">${highlightSQL(data.sql)}</div>
          </div>`;
        }

        if (data.params && Object.keys(data.params).length > 0) {
          const rows = Object.entries(data.params)
            .map(([k, v]) => `<div class="param-row"><span class="param-key">:${escHtml(k)}</span> <span class="op">=</span> <span class="param-val">"${escHtml(String(v))}"</span></div>`)
            .join('');
          inner += `<div class="params-block"><div class="params-label">PARAMETERS</div>${rows}</div>`;
        }

        if (data.result && data.result.columns && data.result.columns.length > 0) {
          const cols = data.result.columns.map(c => `<th>${escHtml(c)}</th>`).join('');
          const rows = data.result.rows.map(row =>
            `<tr>${row.map(cell => `<td>${escHtml(cell === null ? 'NULL' : String(cell))}</td>`).join('')}</tr>`
          ).join('');
          inner += `
          <div class="results-block">
            <div class="results-header">
              <span class="results-header-left">ğŸ“Š RESULTS</span>
              <span class="row-count">${data.result.row_count} row${data.result.row_count !== 1 ? 's' : ''}</span>
            </div>
            <div class="table-wrap">
              <table><thead><tr>${cols}</tr></thead><tbody>${rows}</tbody></table>
            </div>
          </div>`;
        }

        if (data.explanation) {
          inner += `<div class="explanation">â„¹ ${escHtml(data.explanation)}</div>`;
        }

        if (data.error) {
          inner += `<div style="color:var(--red);font-family:var(--font-mono);font-size:12px;margin-top:10px;">âš  ${escHtml(data.error)}</div>`;
        }
      }

      div.innerHTML = `
      <div class="avatar">âš¡</div>
      <div class="bubble">
        <div class="bubble-inner">${inner}</div>
        <div class="bubble-meta">${now()}</div>
      </div>`;
      ca.appendChild(div);
      scrollToBottom();
    }

    // â”€â”€ SQL Syntax Highlighter â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function highlightSQL(sql) {
      const keywords = /\b(SELECT|FROM|WHERE|JOIN|LEFT|RIGHT|INNER|OUTER|ON|GROUP|BY|ORDER|HAVING|AS|AND|OR|NOT|IN|LIKE|BETWEEN|IS|NULL|LIMIT|OFFSET|DISTINCT|COUNT|SUM|AVG|MIN|MAX|CASE|WHEN|THEN|ELSE|END|DESC|ASC|WITH|UNION|ALL|EXISTS|INTO|SET|INSERT|UPDATE|DELETE|TOP|FETCH|NEXT|ROWS|ONLY)\b/gi;
      const strings = /'([^']*)'/g;
      const numbers = /\b(\d+(?:\.\d+)?)\b/g;
      const params = /(:[\w_]+)/g;

      return escHtml(sql)
        .replace(strings, `<span class="str">'$1'</span>`)
        .replace(keywords, `<span class="kw">$1</span>`)
        .replace(numbers, `<span class="num">$1</span>`)
        .replace(params, `<span class="op">$1</span>`);
    }

    // â”€â”€ Copy SQL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function copySQL(id, sql) {
      await navigator.clipboard.writeText(sql).catch(() => { });
      const btn = document.getElementById('copy-' + id);
      if (btn) {
        btn.textContent = 'Copied!';
        btn.classList.add('copied');
        setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 2000);
      }
    }

    // â”€â”€ HTML escape â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function escHtml(str) {
      if (str === null || str === undefined) return '';
      return String(str)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;');
    }
  </script>
</body>

</html>